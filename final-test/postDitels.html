<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="asstis/css/style.css">
    <!-- bootstrab-link -->
    <script src="../node_modules/bootstrap/dist/js/bootstrap.bundle.min.js.map"></script>
    <link rel="stylesheet" href="../node_modules/bootstrap/dist/css/bootstrap.min.css">
    <script src="../node_modules/axios/dist/axios.min.js"></script>
</head>
<body>
<!-- moddeiles -->
<div class="modal fade" id="Login-model" tabindex="-1" role="dialog" aria-bs-labelledby="exampleModalLabel" aria-bs-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Login</h5>
          <button type="button" class="close" data-bs-dismiss="modal" aria-bs-label="Close">
            <span aria-bs-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <form>
            <div class="form-group">
              <label for="recipient-name" class="col-form-label">Username:</label>
              <input type="text" class="form-control" id="Username-input">
            </div>
            <div class="form-group">
              <label for="message-text" class="col-form-label">password:</label>
              <input type="password" class="form-control" id="password-input">
            </div> 
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" onclick="loginbutclick()">Login</button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- loader html -->
<div id="loaderJs">
  <div class="lds-ripple">
      <div></div><div></div>
  </div>
</div>

  <div class="modal fade" id="Regster-model" tabindex="-1" role="dialog" aria-bs-labelledby="exampleModalLabel" aria-bs-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Regster a new user</h5>
          <button type="button" class="close" data-bs-dismiss="modal" aria-bs-label="Close">
            <span aria-bs-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <form>
            <div class="form-group mt-3">
              <label for="recipient-name" class="col-form-label">Image:</label>
              <input type="file" class="form-control" id="regster-Image-input">
            </div>
            <div class="form-group">
              <label for="recipient-name" class="col-form-label">name:</label>
              <input type="text" class="form-control" id="regster-name-input">
            </div>
            <div class="form-group">
              <label for="recipient-name" class="col-form-label">Username:</label>
              <input type="text" class="form-control" id="regster-usrname-input">
            </div>
            <div class="form-group">
              <label for="message-text" class="col-form-label">password:</label>
              <input type="password" class="form-control" id="regster-password-input">
            </div> 
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" onclick="regsterBtnclicked()">Login</button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- moddeiles add-posts -->
  <div class="modal fade" id="add-posts" tabindex="-1" role="dialog" aria-bs-labelledby="exampleModalLabel" aria-bs-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Create A New Post</h5>
          <button type="button" class="close" data-bs-dismiss="modal" aria-bs-label="Close">
            <span aria-bs-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <form>
            <div class="form-group">
              <label for="recipient-name" class="col-form-label">title:</label>
              <input type="text" class="form-control" id="post-title-input">
            </div>
            <div class="form-group mt-3">
              <textarea name="" id="post-body-input"></textarea>
            </div>
            <div class="form-group mt-3">
              <label for="recipient-name" class="col-form-label">Image:</label>
              <input type="file" class="form-control" id="post-image-input">
            </div>
           
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" onclick="CreatNewPostClicked()">Create</button>
        </div>
      </div>
    </div>
  </div>
  <!-- /moddeiles -->
  
  <!-- Aleerts -->
  <div id="liveAlertPlaceholder" class="show fade"></div>
  

    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <a class="navbar-brand" href="./index.html">Navbar</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-bs-controls="navbarNavDropdown" aria-bs-expanded="true" aria-bs-label="Toggle navigation" >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNavDropdown">
          <ul class="navbar-nav">
            <li class="nav-item active">
              <a class="nav-link active" href="./index.html">Home <span class="sr-only"></span></a>
            </li>
            <li class="nav-item">
                <a class="nav-link" onclick="profileCliced()">profile</a>
            </li>

      
          </ul>
          <div class="buttons">
            <button id="button-login" class="btn btn-outline-success" type="button" data-bs-toggle="modal" data-bs-target="#Login-model">Login</button>
            <button type="button"id="button-regster" data-bs-toggle="modal" data-bs-target="#Regster-model" class="btn btn-outline-danger">regster</button>
       </div>


       <!-- logout button -->
       <div class="buttons log-out" id="logout-div">
        <span id="profile-sign-in"> 
          <img id="profile-image" src="https://w7.pngwing.com/pngs/831/88/png-transparent-user-profile-computer-icons-user-interface-mystique-miscellaneous-user-interface-design-smile-thumbnail.png" alt="">
          <b id="userName">@yarob</b>
        </span>
       
        <button onclick="Logout()" type="button"id="logout" class="btn btn-outline-danger">logout</button>

      </div>
        </div>
      </nav>
         
      <div class="all-Posts-dithgls">
                <div class="title-post">
                    <h3><span id="title-post">khlied</span>  Post</h3>
                </div>

        <div class="card item">

            <div class="card-header">
                <span class="img-user"><img src="https://w7.pngwing.com/pngs/831/88/png-transparent-user-profile-computer-icons-user-interface-mystique-miscellaneous-user-interface-design-smile-thumbnail.png" alt=""></span>
                 <h5 class="user-name">@yarhmm</h5> 
                </div>
                
            <div class="card-body">
            <div class="img-card">
                <img src="https://pic.i7lm.com/wp-content/uploads/2019/07/beach-exotic-holiday-248797-780x405.jpg" alt="">
                <h6 class="time-post">2 min ago</h6>
            </div>
              <h5 class="card-title">Special title treatment</h5>
              <p class="card-text">With supporting text below as a natural lead-in to additional content.</p>
            </div>
                <div class="card-footer">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pen" viewBox="0 0 16 16">
                        <path d="m13.498.795.149-.149a1.207 1.207 0 1 1 1.707 1.708l-.149.148a1.5 1.5 0 0 1-.059 2.059L4.854 14.854a.5.5 0 0 1-.233.131l-4 1a.5.5 0 0 1-.606-.606l1-4a.5.5 0 0 1 .131-.232l9.642-9.642a.5.5 0 0 0-.642.056L6.854 4.854a.5.5 0 1 1-.708-.708L9.44.854A1.5 1.5 0 0 1 11.5.796a1.5 1.5 0 0 1 1.998-.001zm-.644.766a.5.5 0 0 0-.707 0L1.95 11.756l-.764 3.057 3.057-.764L14.44 3.854a.5.5 0 0 0 0-.708l-1.585-1.585z"/>
                      </svg>
                        <span class="commonts-numbar">(1)</span>
                    <p>commonts</p>
                </div> 
                
          </div>
                           <!-- commintes -->
                           <div class="all-commints" id="all-comints-posts">
                           <div class="user-Commints">

                            <div class="card-header">
                                <span class="img-user"><img src="https://w7.pngwing.com/pngs/831/88/png-transparent-user-profile-computer-icons-user-interface-mystique-miscellaneous-user-interface-design-smile-thumbnail.png" alt=""></span>
                                 <h5 class="user-name">@yarhmm</h5> 
                                </div>
                                
                            <div class="card-body mt-2">

                               
                          
                              <h5 class="card-title">Special title treatment</h5>
                              <p class="card-text">With supporting text below as a natural lead-in to additional content.</p>
                              <h6 class="time-post">2 min ago</h6>
                            </div>
                           </div>

                           <div class="user-Commints">

                            <div class="card-header">
                                <span class="img-user"><img src="https://w7.pngwing.com/pngs/831/88/png-transparent-user-profile-computer-icons-user-interface-mystique-miscellaneous-user-interface-design-smile-thumbnail.png" alt=""></span>
                                 <h5 class="user-name">@yarhmm</h5> 
                                </div>
                                
                            <div class="card-body mt-2">

                               
                          
                              <h5 class="card-title">Special title treatment</h5>
                              <p class="card-text">With supporting text below as a natural lead-in to additional content.</p>
                              <h6 class="time-post">2 min ago</h6>
                            </div>
                           </div>
                           
                          </div>
                           <!-- commintes// -->


      </div>
      

</body>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
<script src="asstis/js/js-bootstrab/bootstrap.min.js"></script>
<script src="./asstis/js/main.js"></script>
<script src="asstis/js/all.min.js"></script>
<script>
    const urlParmas = new URLSearchParams(window.location.search);
      const  id =  urlParmas.get("postId");
      readReqostes()
      
   function readReqostes() {
    let basURL = `https://tarmeezAcademy.com/api/v1`
    toggleLoader(true);

    axios.get(`${basURL}/posts/${id}`)
    .then((response) => {
        let posts = response.data.data; 
        const post = response.data.data
        const commonts = post.comments
        const author = post.author
    document.getElementById("title-post").innerHTML = author.username
    let commrntsContent = ``
      for(comment of commonts) {
        commrntsContent += `
        <div class="user-Commints">

          <div class="card-header">
              <span class="img-user"><img src="${comment.author.profile_image}"></span>
              <h5 class="user-name">@${comment.author.username}</h5> 
              </div>
              
          <div class="card-body my-2 px-2">

            

            <p class="card-text">${comment.body}</p>
          
          </div>
          </div>
    `
  }
  document.querySelector(".all-Posts-dithgls").innerHTML = "";


  

            let postContent = `
            <div class="title-post">
                    <h3><span id="title-post">${post.author.username}</span>  Post</h3>
                </div>    

        <div class="card item">

        <div class="card-header">
            <span class="img-user"><img src=${post.author.profile_image == "https://w7.pngwing.com/pngs/831/88/png-transparent-user-profile-computer-icons-user-interface-mystique-miscellaneous-user-interface-design-smile-thumbnail.png"} alt=""></span>
            <h5 class="user-name">@${post.author.username}</h5> 
            </div>
            
        <div class="card-body">
        <div class="img-card">
            <img src="${post.image}" alt="">
            <h6 class="time-post">${post.created_at}</h6>
        </div>
        <h5 class="card-title">${post.title}</h5>
        <p class="card-text">${post.body}</p>
        </div>
            <div class="card-footer">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pen" viewBox="0 0 16 16">
                    <path d="m13.498.795.149-.149a1.207 1.207 0 1 1 1.707 1.708l-.149.148a1.5 1.5 0 0 1-.059 2.059L4.854 14.854a.5.5 0 0 1-.233.131l-4 1a.5.5 0 0 1-.606-.606l1-4a.5.5 0 0 1 .131-.232l9.642-9.642a.5.5 0 0 0-.642.056L6.854 4.854a.5.5 0 1 1-.708-.708L9.44.854A1.5 1.5 0 0 1 11.5.796a1.5 1.5 0 0 1 1.998-.001zm-.644.766a.5.5 0 0 0-.707 0L1.95 11.756l-.764 3.057 3.057-.764L14.44 3.854a.5.5 0 0 0 0-.708l-1.585-1.585z"/>
                </svg>
                    <span class="commonts-numbar">
                      (${post.comments_count} ) Commonts
                          <span id="post-tags-${post.id}">
                            
                            </span
                      </span>
            
            </div>            
        </div>
        <div class="input-send-commint" id="add-comment-div" >
              <input id="comment-input" type="text" placeholder="add your comment here...">
              <button class="d-inline-block btn btn-outline-dark" type="button" onclick="creatCommentCliced()"> Send </button>
              </div>
        <div class="all-commints" id="all-comints-posts">
          ${commrntsContent}
          </div>
        </div>
            `
            document.querySelector(".all-Posts-dithgls").innerHTML = postContent;
        
        }).catch((error) => {
            showScuse( error, "danger")    
            }).finally(() => {
              toggleLoader(false);
            })
}


function creatCommentCliced() {

let commont = document.getElementById("comment-input").value;
    const parms = {
        "body": commont
    }
    let token = localStorage.getItem("token");
    SETUI()
const baceurl = `https://tarmeezacademy.com/api/v1`
toggleLoader(true);
axios.post(`${baceurl}/posts/${id}/comments` , parms , {
    headers: {
        "authorization": `Bearer ${token}`
    }
})
.then((resonse) => {
    console.log(resonse)
    showScuse("the comment has been created successfull" , "success")   
    readReqostes()
})
.catch((error) => {
  let massgeError = error.resonse
  showScuse( massgeError, "danger")   
}).finally(()=> {
  toggleLoader(false);

})

}


</script>

</html>
